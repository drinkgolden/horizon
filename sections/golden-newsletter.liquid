{% comment %}
  Golden newsletter signup section using customer form submission.
{% endcomment %}
<section id="golden-newsletter-{{ section.id }}" class="golden-newsletter section" data-section-id="{{ section.id }}" data-section-type="golden-newsletter">
  <div class="golden-newsletter__inner">
    <h4 class="golden-newsletter__title">{{ section.settings.newsletter_text }}</h4>
    {% assign newsletter_form_id = 'Newsletter-' | append: section.id %}
    {% form 'customer', id: newsletter_form_id, class: 'golden-newsletter__form' %}
      {% if form.posted_successfully? %}
        <p class="golden-newsletter__success">{{ section.settings.success_message }}</p>
      {% else %}
        <div class="golden-newsletter__form-group">
          <input type="email" name="contact[email]" id="Email-{{ section.id }}" placeholder="{{ section.settings.placeholder_text }}" required class="golden-newsletter__input">
          <button type="submit" class="golden-newsletter__button">{{ section.settings.button_label }}</button>
        </div>
        {% if form.errors %}
          <div class="golden-newsletter__error">{{ form.errors | default_errors }}</div>
        {% endif %}
      {% endif %}
    {% endform %}
  </div>
</section>

{% schema %}
{
  "name": "Golden Newsletter",
  "tag": "section",
  "class": "section",
  "settings": [
    {
      "type": "text",
      "id": "newsletter_text",
      "label": "Newsletter Prompt",
      "default": "Join our newsletter to stay up to date on features and releases"
    },
    {
      "type": "text",
      "id": "placeholder_text",
      "label": "Email Placeholder",
      "default": "Enter your email address"
    },
    {
      "type": "text",
      "id": "button_label",
      "label": "Button Label",
      "default": "Subscribe"
    },
    {
      "type": "text",
      "id": "success_message",
      "label": "Success Message",
      "default": "Thank you for subscribing!"
    }
  ],
  "presets": [
    {
      "name": "Golden Newsletter",
      "category": "Golden"
    }
  ]
}
{% endschema %}
