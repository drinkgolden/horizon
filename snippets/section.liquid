{%- doc -%}
  Renders a wrapper section

  @param {section} section - The section object
  @param {string} children - The children of the section
{%- enddoc -%}

{%- assign split_divider_color = section.settings.split_divider_color | default: settings.section_gridline_color | default: '#d9d9d9' -%}
{%- assign group_block_count = 0 -%}
{%- assign has_only_group_blocks = true -%}
{%- for block in section.blocks -%}
  {%- if block.type == 'group' -%}
    {%- assign group_block_count = group_block_count | plus: 1 -%}
  {%- else -%}
    {%- assign has_only_group_blocks = false -%}
  {%- endif -%}
{%- endfor -%}

{%- assign show_split_divider = false -%}
{%- if group_block_count > 1 and section.settings.content_direction == 'row' -%}
  {%- assign show_split_divider = true -%}
{%- endif -%}

{%- assign is_split_showcase = false -%}
{%- if section.blocks.size > 0
  and section.settings.content_direction == 'row'
  and section.settings.section_height == 'large'
  and section.settings.section_width == 'full-width'
  and has_only_group_blocks -%}
  {%- assign is_split_showcase = true -%}
{%- endif -%}
{%- assign split_mode = '' -%}
{%- if is_split_showcase -%}
  {%- assign split_mode = 'carousel' -%}
  {%- assign show_split_divider = false -%}
{%- endif -%}

<div class="section-background color-{{ section.settings.color_scheme }}"></div>
<div
  class="section section--{{ section.settings.section_width }} color-{{ section.settings.color_scheme }}"
  data-testid="ui-test-section"

  {% if request.visual_preview_mode %}
    data-shopify-visual-preview
  {% endif %}

  style="
    {% if section.settings.section_height == 'custom' %}
      --section-min-height: {{ section.settings.section_height_custom }}svh;
    {% elsif section.settings.section_height == 'full-screen' %}
      --section-min-height: 100svh;
    {% elsif section.settings.section_height != '' %}
      --section-min-height: var(--section-height-{{ section.settings.section_height }});
    {% endif %}

    {% if section.settings.section_height != '' %}
     --section-preview-height: 600px;
     {% endif %}
  "
>
  <div class="custom-section-background">
    {% render 'background-media',
      background_media: section.settings.background_media,
      background_video: section.settings.video,
      background_video_position: section.settings.video_position,
      background_image: section.settings.background_image,
      background_image_position: section.settings.background_image_position
    %}
  </div>

  <div
    class="border-style custom-section-content"
    style="
      {% render 'border-override', settings: section.settings %}
      overflow: hidden;
      {% if is_split_showcase %}
        --split-divider-color: {{ split_divider_color }};
      {% endif %}
    "
  >
    {% if section.settings.toggle_overlay %}
      {% render 'overlay', settings: section.settings, layer: '0' %}
    {% endif %}

    <div
      class="
        spacing-style
        layout-panel-flex
        layout-panel-flex--{{ section.settings.content_direction }}
        section-content-wrapper
        {% if section.settings.vertical_on_mobile %} mobile-column{% endif %}
      "
      style="
        {% render 'layout-panel-style', settings: section.settings %}
        {% render 'spacing-style', settings: section.settings %}
        {% if is_split_showcase %}
          --split-divider-color: {{ split_divider_color }};
        {% elsif show_split_divider %}
          --split-divider-color: {{ split_divider_color }};
        {% endif %}
      "
      data-testid="section-content"
      {% if is_split_showcase %}data-split-showcase="{{ split_mode }}"{% endif %}
      {% if show_split_divider %}data-split-divider="true"{% endif %}
    >
      {% if is_split_showcase and split_mode == 'carousel' %}
        {% render 'split-showcase-carousel', section: section, split_divider_color: split_divider_color %}
      {% else %}
        {{ children }}
      {% endif %}
    </div>
  </div>
</div>

{% stylesheet %}
  .section-wrapper {
    --section-height-offset: 0px;
  }

  .section[data-shopify-visual-preview] {
    min-height: var(--section-preview-height);
    padding-top: 0;
  }

  .section[data-shopify-visual-preview] .custom-section-background {
    display: none;
  }

  body:has(> #header-group > .header-section > #header-component[transparent]):not(
      :has(> #header-group > .header-section + .shopify-section)
    )
    > main
    > .section-wrapper:first-child {
    --section-height-offset: var(--header-height, 0px);
  }

  .custom-section-background {
    grid-column: 1 / -1;
  }

  .custom-section-content {
    position: relative;
    z-index: var(--layer-flat);
  }
{% endstylesheet %}
